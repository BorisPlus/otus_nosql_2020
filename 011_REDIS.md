# Redis

Домашнее задание. Необходимо:
- сохранить большой жсон (~20МБ) в виде разных структур:
    - строка 
    - сложная структура из hset, zset, list
- протестировать скорость сохранения и чтения
- предоставить отчет

* настроить редис кластер на 3х нодах с отказоусточивостью, затюнить таймоуты
Критерии оценки: Критерии оценки:
- задание выполнено - 5 баллов
- предложено красивое решение - плюс 1 балл
- предложено рабочее решение, но не устранены недостатки, указанные преподавателем - минус 1 балл
Рекомендуем сдать до: 27.11.2020

## Json Data

__Ремарка__: cложно найти действительно хороший Json для задачи. 
Чтобы честно замерить время вставки данных, Json-набор не должен предполагать проведение с ним манипуляций и преобразований.
Можно было бы провести конвертирование выбранного мной набора в тот вид Json, который потребовал бы
непосредственно только вставки данных в БД, без предварительных изменений значений полей. Но я не стал. (Могу сделать, если надо).
Для пояснения этой мысти в скриптах вставки данных я указал на те места, в которых процессорное время отнимается самим скриптом, 
так как имеется то или иное преобразование, что я и отметил фразой в коде скриптов "# Внимание: тут тратится время на ...".

__Вопрос__: В рамках данного исследования можно пренебречь вышеописанным или все же преобразовать в "хороший" для чистого эксперимента по вставке Json?

[Реестр муниципальных маршрутов регулярных перевозок пассажиров и багажа автомобильным и наземным электрическим транспортом в городе Москве](https://data.gov.ru/opendata/7704786030-municipalroutesregister) и [json-данные ~ 60 МБ](https://data.gov.ru/sites/default/files/opendata/7704786030-MunicipalRoutesRegister/data-2017-07-18T00-00-00-structure-2017-07-18T00-00-00.json)

Структура:
 - "system_object_id":("STRING"),
 - "CarrierName" ("STRING", Наименование юридического лица или индивидуального предпринимателя, осуществляющего перевозки пассажиров по маршруту"),
 - "global_id" ("NUMBER"),
 - "RouteNumber" ("STRING", "Номер маршрута"),
 - "DirectRouteTrack" ("STRING", "Координаты прямого трека маршрута"),
 - "ReverseTrackOfFollowing" ("STRING", "Трасса следования маршрута (обратное направление)"),
 - "is_deleted" ("NUMBER"),
 - "signature_date" ("STRING"),
 - "ReverseRouteTrack" ("STRING", "Координаты обратного трека маршрута"),
 - "TrackOfFollowing" ("STRING", "Трасса следования маршрута (прямое направление)"),
 - "RouteName" ("STRING", "Наименование маршрута"),
 - "ID" ("INTEGER", "Код"),
 - "TypeOfTransport" ("DICTIONARY", "Вид транспорта").
 
## Поставить зависимости

```bash
pip3 install -r ./011.files/req.txt 
```

## Время на вставку даннных

Как строка

[Cкрипт загрузки JSON как строки](011.files/load_as_string.py)

```bash
python3 load_as_string.py

Load json as true-string.
         Were load: 1022 units
         Time left: 1.8824961185455322 ms
```

Как сложная структура из hset, zset, list

[Cкрипт загрузки JSON как сложной структуры](011.files/load_as_structure.py)

```bash
python3 load_as_structure.py

Load json as complex structure.
         hset - https://redis.io/commands/hset
         zadd - https://redis.io/commands/zadd
         list - https://redis.io/commands/lpush
         Were load: 1022 units
         Time left: 4.957089900970459 ms
```

Вилим строка вставляется быстрее

